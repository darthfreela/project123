<div class="alert-error">
  <%= flash[:error] %>
  <% if @opm.errors.any? %>
    <div id="error_explanation">
      O formulário contém <%= pluralize(@opm.errors.count, "erro") %>.
    </div>
    <ul>
      <% @opm.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  <% end %>
</div>
<%= form_for @opm do |f| %>
  <div class="box-body">
    <div class="form-group col-md-2">
      <label>Sigla</label>*
      <%= f.text_field :initials, placeholder: "Sigla", maxlength: "6", class:"form-control" %>
    </div>
    <div class="form-group col-md-5">
      <label>Nome</label>*
      <%= f.text_field :name, placeholder: "Nome", class:"form-control" %>
    </div>
    <div class="col-md-3 form-group ">
      <label>Estado</label>
      <select id="states" class="form-control select2">
        <option value="0">Selecionar Estado</option>
        <option value="AC">Acre</option>
        <option value="AL">Alagoas</option>
        <option value="AP">Amapá</option>
        <option value="AM">Amazonas</option>
        <option value="BA">Bahia</option>
        <option value="CE">Ceará</option>
        <option value="DF">Distrito Federal</option>
        <option value="ES">Espirito Santo</option>
        <option value="GO">Goiás</option>
        <option value="MA">Maranhão</option>
        <option value="MS">Mato Grosso do Sul</option>
        <option value="MT">Mato Grosso</option>
        <option value="MG">Minas Gerais</option>
        <option value="PA">Pará</option>
        <option value="PB">Paraíba</option>
        <option value="PR">Paraná</option>
        <option value="PE">Pernambuco</option>
        <option value="PI">Piauí</option>
        <option value="RJ">Rio de Janeiro</option>
        <option value="RN">Rio Grande do Norte</option>
        <option value="RS">Rio Grande do Sul</option>
        <option value="RO">Rondônia</option>
        <option value="RR">Roraima</option>
        <option value="SC">Santa Catarina</option>
        <option value="SP">São Paulo</option>
        <option value="SE">Sergipe</option>
        <option value="TO">Tocantins</option>
      </select>
    </div>
    <div class="col-md-5 form-group ">
      <label>Cidade</label>
      <%= f.collection_select :city_id, [], :id, :name, :include_blank => 'Selecionar primeiro Estado'%>
    </div>
  </div>
  <div class="box-footer">
    <%= f.submit "Salvar", class: "btn btn-success" %>
    <%= f.button "Limpar", class: "btn btn-danger" %>
    <div class=" small pull-right">* Campos obrigatórios</div>
  </div>
  <script type="text/javascript">
    $("#opm_city_id").addClass( "form-control select2" );
    $(document).ready(function() {
      $("#states").change(function() {
        getCitiesByState("uf="+$("#states").val());
      });
    
    });

    function getCitiesByState(uf) {

      $.getJSON("/cities_opm", uf, function(j) {
        var options = '<option value="">Selecionar Cidade</option>';
          $.each(j.cty, function(i, item) {   
          options += '<option value="' + item.id + '">' + item.n + '</option>';
        });
        $("#opm_city_id").html(options);
      });

    }
  </script>
<% end %> 